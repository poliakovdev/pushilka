function Pushilka(e){var a=o(),c={endpoint:"https://push.wuazu.net/push_subscription.php",eventEndpoint:"https://push.wuazu.net/event",serviceWorker:"/serviceWorker.js",serviceWorkerOptions:{scope:"/"},applicationServerKey:"BCmIwkLHxJNPccoVf2UXDjd7kDuiyJpKsSOqSHCtGBMfBkjfHLCq4-d8eNtabNlCNKFF8CZIzeDwOo3OvNCQAns",source:"",var1:"",var2:"",var3:"",var4:"",done:function(){},success:function(){},decline:function(){}};for(var n in e)e.hasOwnProperty(n)&&c.hasOwnProperty(n)&&(c[n]=e[n]);function t(e){fetch(c.eventEndpoint,{method:"POST",body:JSON.stringify({event:e,source:c.source,visitorId:s(),sessionId:a,var1:c.var1,var2:c.var2,var3:c.var3,var4:c.var4})}).catch()}function r(){navigator.serviceWorker.ready.then(function(e){return t("sys_push_invoked"),e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){for(var n=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(n),r=new Uint8Array(t.length),o=0;o<t.length;++o)r[o]=t.charCodeAt(o);return r}(c.applicationServerKey)})}).then(function(e){return i(e,"POST")}).catch(function(){t("sys_push_blocked"),c.decline()})}function o(){for(var e=[],n=0;n<2;n++)e.push(Math.floor(4294967295*Math.random()).toString(36));return e.join("-")}function s(){var e=window.localStorage,n=e.getItem("visitorId")||o();return e.setItem("visitorId",n),n}function i(e,n){var t,r=e.getKey("p256dh"),o=e.getKey("auth"),i=(PushManager.supportedContentEncodings||["aesgcm"])[0];return fetch((t=c.endpoint,t+"?vid="+encodeURIComponent(s())+"&sid="+encodeURIComponent(a)+"&s="+encodeURIComponent(c.source.toString())+"&var1="+encodeURIComponent(c.var1.toString())+"&var2="+encodeURIComponent(c.var2.toString())+"&var3="+encodeURIComponent(c.var3.toString())+"&var4="+encodeURIComponent(c.var4.toString())),{method:n,body:JSON.stringify({endpoint:e.endpoint,publicKey:r?btoa(String.fromCharCode.apply(null,new Uint8Array(r))):null,authToken:o?btoa(String.fromCharCode.apply(null,new Uint8Array(o))):null,contentEncoding:i})}).then(function(){return c.done(),c.success(),e}).catch(function(){c.done(),c.success()})}this.ready=function(e){"interactive"===document.readyState||"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e)},this.run=function(){this.ready(function(){navigator.serviceWorker.register(c.serviceWorker,c.serviceWorkerOptions),navigator.serviceWorker.ready.then(function(e){return e.pushManager.getSubscription()}).then(function(e){return e?i(e,"PUT"):r()})})}}